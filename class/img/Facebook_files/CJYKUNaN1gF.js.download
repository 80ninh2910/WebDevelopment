;/*FB_PKG_DELIM*/

__d("CometComposerDraftingUtils",["Promise","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i="comet_composer_drafts",j="drafts",k=1,l="draft_content",m=1;function a(){var a;return(a=c("qex")._("1805"))!=null?a:!1}function d(a){return new(h||(h=b("Promise")))(function(b,c){var d=window.indexedDB.open(i,k);d.onerror=function(){c(d.error)};d.onupgradeneeded=function(a){a=a.target.result;if(!a.objectStoreNames.contains(j)){a=a.createObjectStore(j,{keyPath:"id"});a.createIndex(l,[l],{unique:!1})}};d.onsuccess=function(c){var d=c.target.result;c=d.transaction(j,"readwrite");var e=c.objectStore(j);e.put({draftViewState:a,id:m});c.oncomplete=function(){d.close(),b(!0)}}})}function e(){return new(h||(h=b("Promise")))(function(a,b){var c=window.indexedDB.open(i,k);c.onerror=function(){b(c.error)};c.onsuccess=function(c){var d=c.target.result,e=d.transaction(j,"readonly");c=e.objectStore(j);var f=c.get(m);e.oncomplete=function(){d.close(),a(f)};e.onerror=function(){d.close(),b(e.error)}}})}g.canDraftPosts=a;g.addDraftToIndexDB=d;g.getDraftFromIndexDB=e}),98);
__d("getComposerValidationErrors",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c={};for(var d in a){var e=a[d];e=e(b);e!=null&&(c[d]=e)}return c}f["default"]=a}),66);
__d("getIneligibleComposerFeatures",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=new Set();for(var d in a){var e=a[d];e=e(b);e!=null&&e.forEach(function(a){return c.add(a)})}return c}f["default"]=a}),66);
__d("getShouldTriggerUnsavedChangesFlow",[],(function(a,b,c,d,e,f){"use strict";function a(a){return!Boolean(a==null?void 0:a.ignoreDirtyFlag)&&Boolean(a==null?void 0:a.isDirty)}f["default"]=a}),66);
__d("useComposerLexicalEligibilityCheckHooks.react",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c=new Set();if(b!=null)for(var d in b){var e=b[d];e=e(a);e.size>0&&e.forEach(function(a){return c.add(a)})}return c}f["default"]=a}),66);
__d("useComposerLexicalValidationHooks.react",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){var c={};if(b!=null)for(var d in b){var e=b[d];e=e(a);e!=null?c[d]=e:c[d]!=null&&delete c[d]}return c}f["default"]=a}),66);
__d("CometComposer.react",["CometComposerDraftingUtils","CometComposerFeatureDefinitionsContext","CometComposerFormRefContext","CometComposerIneligibilityContext","CometComposerLoggerDispatcherContext","CometComposerPluginsContext","CometComposerPluginsDispatchContext","CometComposerPreSubmitHooksContext","CometComposerValidationErrorsContext","CometComposerViewStateAlteredContext","CometComposerViewStateContext","CometComposerViewStateDispatcherContext","CometComposerViewStateReducersContext","CometOnBeforeUnload.react","FBLogger","Promise","cometComposerPluginsReducers","cr:8094","createEmptyCometComposerViewStateWithTarget","getComposerUnsavedChangesAlert","getComposerValidationErrors","getIneligibleComposerFeatures","getShouldTriggerUnsavedChangesFlow","react","reduceComposerViewState","shallowEqual","useComposerLexicalEligibilityCheckHooks.react","useComposerLexicalValidationHooks.react","useComposerTerminalEventLog"],(function(a,b,c,d,e,f,g){"use strict";var h=["ref"],i,j,k=j||(j=d("react"));e=j;var l=e.useCallback,m=e.useEffect,n=e.useImperativeHandle,o=e.useMemo,p=e.useReducer,q=e.useRef;function a(a){var e=a.ref;a=babelHelpers.objectWithoutPropertiesLoose(a,h);var f=a.beginningViewState,g=a.children,j=a.eligibilityCheckers,r=a.featureDefinitions,s=a.lexicalEligibilityCheckHooks,t=a.lexicalValidationHooks,u=a.loggers,v=a.onBeforeViewStateChange,w=a.onSubmitCommit,x=a.onSubmitHalt,y=a.onSubmitStart,z=a.onValidationErrors,A=a.registerOnBeforeUnload;A=A===void 0?!0:A;var B=a.target,C=a.unalteredBeginningViewState,D=a.validators,E=q(new Map()),F=q(new Map()),G=q({}),H=q(new Set()),I=q(new Map()),J=q(null);a=q(null);f=p(function(a,b){b=c("reduceComposerViewState")(E,F,a,C,b);J.current=b;v&&v(b,a);return b},f,c("createEmptyCometComposerViewStateWithTarget")(B));var K=f[0];f=f[1];var L=function(){if(c("getShouldTriggerUnsavedChangesFlow")(K))return c("getComposerUnsavedChangesAlert")(K)},M=b("cr:8094")(),N=q(null);n(e,function(){return{getViewState:function(){return K},submitAsDraft:function(){if(d("CometComposerDraftingUtils").canDraftPosts()&&N.current!=null){var a=JSON.stringify(K);d("CometComposerDraftingUtils").addDraftToIndexDB(a).then(function(){M!=null&&M()})["catch"](function(a){c("FBLogger")("comet_composer").mustfix(a)})}}}},[K,M]);e=p(c("cometComposerPluginsReducers"),{decorators:new Map(),handlers:new Map()});var O=e[0];e=e[1];var P=o(function(){return D!=null?c("getComposerValidationErrors")(D,K):{}},[D,K]);t=c("useComposerLexicalValidationHooks.react")(K,t);P=babelHelpers["extends"]({},P,t);c("shallowEqual")(G.current,P)||(G.current=P);var Q=o(function(){return j!=null?c("getIneligibleComposerFeatures")(j,K):new Set()},[j,K]);t=c("useComposerLexicalEligibilityCheckHooks.react")(K,s);P=o(function(){return{featureDefinitions:r}},[r]);(H.current.size!==Q.size+t.size||!Array.from(Q).every(function(a){return H.current.has(a)})||!Array.from(t).every(function(a){return H.current.has(a)}))&&(t.forEach(function(a){return Q.add(a)}),H.current=new Set(Q));var R=l(function(a,c){a!=null&&a.type!=="press"&&a.preventDefault();if(Object.keys(G.current).length>0){z&&z(G.current);return}var d=J.current;if(d==null)return;y&&y(d);a=I.current;if(a){a=Array.from(a.keys()).reduce(function(a,e){return a.then(function(){return new(i||(i=b("Promise")))(function(a,b){e({onContinue:a,onHalt:b},d,c)})})},(i||(i=b("Promise"))).resolve());a.then(function(){w(d,c)})["catch"](function(){x&&x(d)})}else w(d,c)},[w,x,y,z]),S=K.creationSessionID;m(function(){N.current=R},[R]);s=o(function(){return function(a){S==null?c("FBLogger")("comet_composer").mustfix("creationSessionID should be defined in composer of type "+String(B==null?void 0:B.type)):(u!=null?u:[]).map(function(b){return b(a,S,{target:B})})}},[S,B,u]);c("useComposerTerminalEventLog")(function(){return c("getShouldTriggerUnsavedChangesFlow")(K)},function(){return S});return k.jsx(c("CometComposerPluginsDispatchContext").Provider,{value:e,children:k.jsx(c("CometComposerPluginsContext").Provider,{value:O,children:k.jsx(c("CometComposerFeatureDefinitionsContext").Provider,{value:P,children:k.jsx(c("CometComposerViewStateReducersContext").Provider,{value:E,children:k.jsx(c("CometComposerViewStateAlteredContext").Provider,{value:F,children:k.jsx(c("CometComposerViewStateContext").Provider,{value:K,children:k.jsx(c("CometComposerViewStateDispatcherContext").Provider,{value:f,children:k.jsx(c("CometComposerValidationErrorsContext").Provider,{value:G.current,children:k.jsx(c("CometComposerIneligibilityContext").Provider,{value:H.current,children:k.jsx(c("CometComposerLoggerDispatcherContext").Provider,{value:s,children:k.jsx(c("CometComposerPreSubmitHooksContext").Provider,{value:I,children:k.jsxs(c("CometComposerFormRefContext").Provider,{value:a,children:[k.jsxs("form",{"data-testid":void 0,method:"POST",onSubmit:R,ref:a,children:[o(function(){return g(R)},[g,R]),k.jsx("input",{style:{display:"none"},type:"submit"})]}),A?k.jsx(c("CometOnBeforeUnload.react"),{onBeforeUnload:L}):null]})})})})})})})})})})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);